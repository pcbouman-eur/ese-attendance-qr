(function(e){function t(t){for(var a,s,i=t[0],c=t[1],l=t[2],p=0,d=[];p<i.length;p++)s=i[p],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&d.push(o[s][0]),o[s]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);u&&u(t);while(d.length)d.shift()();return n.push.apply(n,l||[]),r()}function r(){for(var e,t=0;t<n.length;t++){for(var r=n[t],a=!0,i=1;i<r.length;i++){var c=r[i];0!==o[c]&&(a=!1)}a&&(n.splice(t--,1),e=s(s.s=r[0]))}return e}var a={},o={app:0},n=[];function s(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=a,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(r,a,function(t){return e[t]}.bind(null,a));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/ese-attendance-qr/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var u=c;n.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("cd49")},"648a":function(e,t,r){"use strict";r("a0d6")},a0d6:function(e,t,r){},cd49:function(e,t,r){"use strict";r.r(t);var a=r("2b0e"),o=r("7496"),n=r("40dc"),s=r("adda"),i=r("f6c4"),c=r("2fa4"),l=function(){var e=this,t=e._self._c;e._self._setupProxy;return t(o["a"],[t(n["a"],{attrs:{app:"",color:"#ffd500"}},[t(s["a"],{staticClass:"shrink mr-2",attrs:{alt:"Erasmus School of Economics",contain:"",src:r("dcb1"),transition:"scale-transition",width:"60"}}),t("div",{staticClass:"d-flex align-center"},[e._v(" Attendance QR-Codes Generator ")]),t(c["a"])],1),t(i["a"],[t("Main")],1)],1)},u=[],p=r("62ad"),d=r("a523"),f=r("ce7e"),h=r("0fd9"),m=r("7e85"),v=r("e516"),b=r("9c54"),g=r("56a4"),_=function(){var e=this,t=e._self._c;e._self._setupProxy;return t(d["a"],[t(h["a"],{attrs:{justify:"center"}},[t(p["a"],{attrs:{cols:"6"}},[t(m["a"],{attrs:{"non-linear":""},model:{value:e.step,callback:function(t){e.step=t},expression:"step"}},[t(b["a"],[t(g["a"],{attrs:{step:"1",complete:e.step>1,editable:""}},[e._v(" Load Schedule Data ")]),t(f["a"]),t(g["a"],{attrs:{step:"2",complete:e.step>2,editable:""}},[e._v(" Define Template URL ")]),t(f["a"]),t(g["a"],{attrs:{step:"3",editable:""}},[e._v(" Generate QR Codes ")])],1),t(b["b"],[t(v["a"],{attrs:{step:"1"}},[t("Step0",{on:{nextStep:function(t){e.step++}}})],1),t(v["a"],{attrs:{step:"2"}},[t("Step1",{on:{nextStep:function(t){e.step++},prevStep:function(t){e.step--}}})],1),t(v["a"],{attrs:{step:"3"}},[t("Step2",{on:{prevStep:function(t){e.step--}}})],1)],1)],1)],1)],1)],1)},y=[],x=r("0798"),w=r("8336"),S=r("b0af"),O=r("99d9"),j=r("8860"),D=r("da13"),C=r("e0c7"),R=function(){var e=this,t=e._self._c;e._self._setupProxy;return t(S["a"],[t(O["c"],[e._v("Load Schedule Data")]),t(O["b"],[t("h3",[e._v("Prepare")]),e._v(" To use this tool you need to have a Spreadsheet file with session exported from "),t("a",{attrs:{href:"https://timetables.eur.nl",target:"_blank"}},[e._v("https://timetables.eur.nl")]),e._v(". Follow these steps to make this export. "),t("ol",[t("li",[e._v("Add the courses for which you want to export data, and make sure only these courses are selected.")]),t("li",[e._v("Click the download button "),t("img",{attrs:{src:"img/timetables-download.png",alt:"Picture of the download button on timetables.eur.nl"}}),e._v(' and choose "Microsoft Excel"')]),t("li",[e._v('Make sure a proper date range is selected that contains all the sessions you want to include. If you have the proper selection, click "Download"')])]),t("br"),t("h3",[e._v("Import Data")]),null==e.scheduleData.sessions||0==e.scheduleData.sessions.length?[t("FileDropZone",{attrs:{accept:".xlsx",acceptError:"Please provide an .xlsx Spreadsheet with a timetables.eur.nl schedule",autoSubmit:!0},on:{change:e.changeFile}})]:e._e(),null!=e.scheduleData.sessions&&e.scheduleData.sessions.length>0?[t(x["a"],{attrs:{color:"success"}},[t("h3",[e._v("Data loaded")]),t("div",[e._v(e._s(e.scheduleData.sessions.length)+" sessions have been loaded.")])]),t(j["a"],[t(C["a"],[e._v("Course Names")]),e._l(e.scheduleData.courseNames,(function(r){return t(D["a"],{key:r},[e._v(e._s(r))])}))],2),t("br"),t(w["a"],{attrs:{color:"error"},on:{click:e.clearData}},[e._v("Clear")])]:e._e()],2),t(f["a"]),t(O["a"],[t(c["a"]),t(w["a"],{attrs:{color:"primary"},on:{click:function(t){return e.$emit("nextStep")}}},[e._v("Next")])],1)],1)},k=[],L=r("9ab4"),T=(r("907a"),r("3c5d"),r("fa9e"),r("77d9"),r("25ca")),U=r("5a0c"),P=r.n(U),F=r("2a04"),$=r.n(F);function I(e){const t=Object(T["a"])(e,{type:"array",cellDates:!0});return E(t)}function E(e){const t=e.Sheets[e.SheetNames[0]],r=W(t),a=r.map(Q),o=[...new Set(r.map(e=>e["Description"]+" ("+e["Course code"]+")"))];return{courseNames:o,sessions:a}}function N(e){const t=new Map,r=A(e);for(const[a,o]of r.entries())t.set(a,M(o));return t}function M(e){return z(e,e=>e.group.name)}function A(e){return z(e,e=>e.courseCode)}function z(e,t){const r=new Map;for(const a of e){const e=t(a);r.has(e)?r.get(e).push(a):r.set(e,[a])}for(const a of r.values())V(a);return r}function Q(e,t){const r=e["Course code"],a=e["Start"],o=e["End"],n={start:a,end:o},s=(r.endsWith("X")||r.endsWith("S"),G(e["Group"],r));return{timeSlot:n,location:e["Location(s)"],id:t,type:e["Type"],group:s,courseCode:r,courseName:e["Description"]}}function G(e,t,r="Group "){const a=e.replace(r,"");if("Plenary"===a)return{groupType:a,plenary:!0,name:a};const o=a.match(/^[A-Za-z]+/),n=a.match(/[0-9]+$/);if(o&&n)return{name:a,groupType:o[0],plenary:!1};const s=t.match(/[A-Za-z]$/);return{name:a+(s?"-"+s[0]:""),groupType:a+(s?"-"+s[0]:""),plenary:!1}}function W(e){const t=e["!ref"];if(!t)throw"Invalid Spreadsheet";const r=T["b"].decode_range(t);let a=!0;const o=[],n={};for(let s=r.s.r;s<=r.e.r;s++){const t={};for(let o=r.s.c;o<=r.e.c;o++){const r=T["b"].encode_cell({r:s,c:o}),i=e[r];if(i)if(a)n[o]=i.v;else{const e=n[o];t[e]=i.v}}a?a=!1:o.push(t)}return o}function q(e,t,r=", etcetera"){if(e.length<=t)return e;const a=e.indexOf(",");return a+r.length<=t?e.substring(0,a)+r:e.substring(0,t)}function V(e){e.sort(Z)}function Z(e,t){const r=new Date(e.timeSlot.start),a=new Date(t.timeSlot.start),o=r.getTime()-a.getTime();if(0!==o)return o;const n=new Date(e.timeSlot.end),s=new Date(t.timeSlot.end);return n.getTime()-s.getTime()}P.a.extend($.a);var B=r("1b40"),H=r("4bb5"),J=r("cc20"),X=r("132d"),Y=r("8dd9"),K=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",[t(Y["a"],{staticClass:"pa-2 sheet",attrs:{tabindex:"0",title:"Click to grap a file from your PC!",color:"secondary lighten-4",width:"100%"},on:{dragenter:e.dragStart,dragover:e.dragStart,dragleave:e.dragEnd,drop:e.drop,click:function(t){return e.$refs.inputEl.click()}}},[t("input",{ref:"inputEl",staticClass:"hidden",attrs:{type:"file",accept:e.accept},on:{change:e.changeFile}}),t(d["a"],[e.currentFiles?e._e():t(h["a"],{attrs:{justify:"center"}},[e.error?t(X["a"],{attrs:{color:"black",size:"75"}},[e._v("mdi-alert-box-outline")]):e.dragover&&!e.error?t(X["a"],{attrs:{color:"black",size:"75"}},[e._v("mdi-plus-box-outline")]):t(X["a"],{attrs:{color:"black",size:"75"}},[e._v("mdi-cloud-upload-outline")])],1),e.currentFiles?e._e():t(h["a"],{attrs:{justify:"center"}},[t("span",{staticClass:"title"},[e._v("Drag'n drop or click to upload file"+e._s(this.allowMultiple?"(s)":"")+"!")])]),e.currentFiles?t(h["a"],{attrs:{justify:"center"}},[t("div",{staticClass:"selection-box"},[t("h3",[e._v("Selected files:")]),e._l(e.currentFiles,(function(r,a){return t(J["a"],{key:"file-"+a,staticClass:"spacing",attrs:{small:""}},[e._v(e._s(r.name))])}))],2)]):e._e(),!e.currentFiles&&!e.error||e.dragover?e._e():t(h["a"],{attrs:{justify:"center"}},[e.error?e._e():t(w["a"],{attrs:{color:"primary"},on:{click:function(t){return t.stopPropagation(),e.submit.apply(null,arguments)}}},[e._v("Submit")]),e.error?e._e():t("span",{staticStyle:{width:"3em"}}),t(w["a"],{attrs:{color:"secondary"},on:{click:function(t){return t.stopPropagation(),e.clear.apply(null,arguments)}}},[e._v("Clear")])],1)],1)],1),e.error?t(x["a"],{attrs:{type:"error"}},[e._v(" "+e._s(e.error)+" ")]):e._e()],1)},ee=[];r("caad");let te=class extends B["d"]{constructor(){super(),this.dragover=!1,this.error=null,this.currentFiles=null}dragStart(e){this.dragging(e,!0)}dragEnd(e){this.dragging(e,!1)}dragging(e,t){e.preventDefault(),this.dragover=t,e.dataTransfer&&e.dataTransfer.items,t||(this.error=null)}checkValidFile(e){if(!this.accept)return!0;for(const t of this.acceptOptions)if(e.name.endsWith(t))return!0;return!!this.acceptOptions.includes(e.type)}validate(e){if(!this.allowMultiple&&1!=e.length)return"Only a single file is supported";for(const t of e)if(this.accept&&!this.checkValidFile(t))return this.acceptError?this.acceptError:"Only files of type '"+this.accept+"' are supported";return null}drop(e){if(e.preventDefault(),e.dataTransfer){const t=e.dataTransfer.files,r=this.validate(t);null==r?(this.currentFiles=t,this.error=null,this.autoSubmit&&this.submit()):this.error=r}this.dragover=!1}changeFile(e){const t=e.target,r=t.files,a=this.validate(r);null==a?(this.currentFiles=r,this.autoSubmit&&this.submit()):this.error=a}clear(){this.currentFiles=null,this.error=null,this.$refs.inputEl.value=""}submit(){const e=this.currentFiles;return this.currentFiles=null,e}get acceptOptions(){return this.accept?this.accept.split(",").map(e=>e.trim()):[]}};Object(L["a"])([Object(B["c"])({default:""})],te.prototype,"accept",void 0),Object(L["a"])([Object(B["c"])({default:null})],te.prototype,"acceptError",void 0),Object(L["a"])([Object(B["c"])({default:!1})],te.prototype,"autoSubmit",void 0),Object(L["a"])([Object(B["c"])({default:!1})],te.prototype,"allowMultiple",void 0),Object(L["a"])([Object(B["b"])("change")],te.prototype,"submit",null),te=Object(L["a"])([B["a"]],te);var re=te,ae=re,oe=(r("648a"),r("2877")),ne=Object(oe["a"])(ae,K,ee,!1,null,"5ae016ea",null),se=ne.exports;let ie=class extends B["d"]{changeFile(e){if(console.log(e),1==e.length){const t=new FileReader;t.addEventListener("load",this.processFile),t.readAsArrayBuffer(e[0])}}processFile(e){var t;const r=null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.result;if(r){const e=I(r);this.setScheduleData(e)}}clearData(){this.setScheduleData({courseNames:[],sessions:[]})}};Object(L["a"])([Object(H["b"])("scheduleData")],ie.prototype,"scheduleData",void 0),Object(L["a"])([Object(H["a"])("setScheduleData")],ie.prototype,"setScheduleData",void 0),ie=Object(L["a"])([Object(B["a"])({components:{FileDropZone:se}})],ie);var ce=ie,le=ce,ue=Object(oe["a"])(le,R,k,!1,null,null,null),pe=ue.exports,de=r("8654"),fe=function(){var e=this,t=e._self._c;e._self._setupProxy;return t(S["a"],[t(O["c"],[e._v("Define Template URL")]),t(O["b"],[t("div",[e._v(" Here you can define the URL template that should be used to generate the URL's for the QR-codes. "),t("br"),e._v(" The following variables can be used in the URL. The contents will be properly escaped for usage in a URL query string. "),t("ul",[t("li",{pre:!0},[e._v("{{courseCode}} : the course code")]),t("li",{pre:!0},[e._v("{{courseName}} : the name of the course")]),t("li",{pre:!0},[e._v("{{time}} : the date and time of the session")]),t("li",{pre:!0},[e._v("{{group}} : the group of the session (this is Plenary for a plenary session)")]),t("li",{pre:!0},[e._v("{{index}} : the number of the session within the sessions of the group")]),t("li",{pre:!0},[e._v("{{sessionId}} : the session ID from the schedule")]),t("li",{pre:!0},[e._v("{{location}} : the room and building in which the session takes place")])])]),t("br"),t(de["a"],{attrs:{value:e.templateURL,label:"Template URL"},on:{change:t=>e.setTemplateURL(t)}})],1),t(f["a"]),t(O["a"],[t(w["a"],{attrs:{color:"primary"},on:{click:function(t){return e.$emit("prevStep")}}},[e._v("Prev")]),t(c["a"]),t(w["a"],{attrs:{color:"primary"},on:{click:function(t){return e.$emit("nextStep")}}},[e._v("Next")])],1)],1)},he=[];let me=class extends B["d"]{};Object(L["a"])([Object(H["b"])("templateURL")],me.prototype,"templateURL",void 0),Object(L["a"])([Object(H["a"])("setTemplateURL")],me.prototype,"setTemplateURL",void 0),me=Object(L["a"])([B["a"]],me);var ve=me,be=ve,ge=Object(oe["a"])(be,fe,he,!1,null,null,null),_e=ge.exports,ye=function(){var e=this,t=e._self._c;e._self._setupProxy;return t(S["a"],[t(O["c"],[e._v("Generate QR Codes")]),t(O["b"],[t("div",[e._v(" Click the button below to generate the QR codes. "),t("br"),t("em",[e._v("(Your browser may become inresponsive for a few seconds while generating the final zip-file)")])]),t(w["a"],{attrs:{block:"",color:"primary"},on:{click:function(t){return e.generate()}}},[e._v("Generate QR Codes")])],1),t(f["a"]),t(O["a"],[t(w["a"],{attrs:{color:"primary"},on:{click:function(t){return e.$emit("prevStep")}}},[e._v("Prev")]),t(c["a"])],1)],1)},xe=[],we=(r("5b81"),r("2801")),Se=r.n(we),Oe=r("c4e3"),je=r.n(Oe),De=r("d055"),Ce=r.n(De);let Re=class extends B["d"]{generate(){const e=[],t=new je.a,r=Se.a.compile(this.templateURL),a=N(this.scheduleData.sessions);for(const[o,n]of a.entries()){const a=o.replaceAll("/","_");t.folder(a);for(const[o,s]of n.entries()){const n=o.replaceAll("/","_");t.folder(`${a}/${n}`);for(const[o,i]of s.entries()){const s=q(i.location,60),c={courseCode:encodeURIComponent(i.courseCode),courseName:encodeURIComponent(i.courseName),time:encodeURIComponent(i.timeSlot.start.toLocaleString()),group:encodeURIComponent(i.group.name),sessionId:encodeURIComponent(i.id),location:encodeURIComponent(s),index:o+1,offset:o},l=r(c),u=new Promise((e,r)=>{const c=document.createElement("canvas");c.width=260,c.height=360,console.log(`Attempting to generate QR code for url of length ${l.length} : ${l}`),Ce.a.toCanvas(c,l,{errorCorrectionLevel:"Q"},(l,u)=>{if(l)r(l);else{const r=c.getContext("2d");if(r){const e=r.getImageData(0,0,u.width,u.height),t=u.height,a=15,n=25;r.font="15px Arial";const c=[`${i.courseCode} ${i.courseName}`,`${i.group.name} Session ${o+1}`,i.timeSlot.start.toLocaleString(),s];let l=u.width;for(const o of c){const e=r.measureText(o);l=Math.max(l,e.width+a)}u.height+=n*c.length,u.width=l,r.putImageData(e,0,0),r.font="15px Arial";for(const[o,s]of c.entries())r.fillText(s,a,t+o*n)}u.toBlob(r=>{t.file(`${a}/${n}/session_${o+1}.png`,r),e()}),u.remove()}})});e.push(u)}}}(async()=>{await Promise.all(e),t.generateAsync({type:"blob"}).then(e=>{const t=document.createElement("a");t.href=window.URL.createObjectURL(e),t.download="qr-codes.zip",t.click(),t.remove()})})()}};Object(L["a"])([Object(H["b"])("templateURL")],Re.prototype,"templateURL",void 0),Object(L["a"])([Object(H["b"])("scheduleData")],Re.prototype,"scheduleData",void 0),Re=Object(L["a"])([B["a"]],Re);var ke=Re,Le=ke,Te=Object(oe["a"])(Le,ye,xe,!1,null,null,null),Ue=Te.exports,Pe=a["a"].extend({name:"HelloWorld",components:{Step0:pe,Step1:_e,Step2:Ue},data:()=>({step:1})}),Fe=Pe,$e=Object(oe["a"])(Fe,_,y,!1,null,null,null),Ie=$e.exports,Ee=a["a"].extend({name:"App",components:{Main:Ie},data:()=>({})}),Ne=Ee,Me=Object(oe["a"])(Ne,l,u,!1,null,null,null),Ae=Me.exports,ze=r("f309");a["a"].use(ze["a"]);var Qe=new ze["a"]({}),Ge=r("2f62");a["a"].use(Ge["a"]);var We=new Ge["a"].Store({state:{scheduleData:{courseNames:[],sessions:[]},templateURL:"https://erasmusuniversity.eu.qualtrics.com/jfe/form/SV_6zzW1oIVYXLtlI2?courseCode={{courseCode}}&courseName={{courseName}}&datetime={{time}}&group={{group}}&sessionIndex={{index}}&sessionId={{sessionId}}&location={{location}}"},mutations:{setScheduleData(e,t){e.scheduleData=t},setTemplateURL(e,t){e.templateURL=t}},actions:{},modules:{}});a["a"].config.productionTip=!1,new a["a"]({vuetify:Qe,store:We,render:e=>e(Ae)}).$mount("#app")},dcb1:function(e,t,r){e.exports=r.p+"img/ese-logo-text.c2adb061.png"}});
//# sourceMappingURL=app.7c76d96c.js.map